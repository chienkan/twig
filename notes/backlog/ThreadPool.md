# 线程池

## 需求分析

系统在创建和销毁线程时耗费CPU资源较大。

## 工作原理

事先创建一定数量的线程，以队列形式存在。当工作队列为空时，所有线程挂起等待新的工作到来。当新的工作到来时，线程队列头开始执行这个任务，然后依次是第二、第三个线程执行新到来的任务，当其中某个线程处理完任务后，那么该线程立马开始接受任务分派，从而让所有线程都处于忙碌的状态，提高并行处理效率。

线程池所涉及到的设计模式是典型的**生产者-消费者**模型。

> 生产者不断的向仓库放入产品，消费者不断的从仓库取出产品，仓库的容量是有限的。因此，当仓库处于满状态时，生产者必须等待消费者取出 1 个或多个产品后才能继续生产；同理，当仓库处于空状态时，消费者必须等待生产者将产品放入仓库后才能消费（取出）产品。

## 常见变量

- 最大线程数
- 布尔值，表示线程池是否关闭
- 线程ID数组
- 线程锁
- 布尔值，表示可以接受任务分派
- 任务入口，routine函数
- routine函数参数指针
- next指针，指向队列中下一个任务

## 常见接口

  - 创建线程池
  - 销毁线程池
  - 分派任务

## 参考

https://zhuanlan.zhihu.com/p/44971598

https://blog.csdn.net/quzhongxin/article/details/47787543

